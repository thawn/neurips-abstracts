<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeurIPS Abstracts Explorer</title>

    <!-- Tailwind CSS for modern styling -->
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/tailwind.css') }}">

    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="{{ url_for('static', filename='vendor/fontawesome.min.css') }}">

    <!-- Marked.js for Markdown rendering -->
    <script src="{{ url_for('static', filename='vendor/marked.min.js') }}"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Smooth transitions */
        * {
            transition: all 0.2s ease;
        }

        /* Gradient background */
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* Card hover effect */
        .paper-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        /* Chat bubble animations */
        .chat-message {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Loading spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Markdown content styling */
        .markdown-content {
            line-height: 1.6;
        }

        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3,
        .markdown-content h4,
        .markdown-content h5,
        .markdown-content h6 {
            font-weight: 600;
            margin-top: 1em;
            margin-bottom: 0.5em;
        }

        .markdown-content h1 {
            font-size: 1.5em;
        }

        .markdown-content h2 {
            font-size: 1.3em;
        }

        .markdown-content h3 {
            font-size: 1.1em;
        }

        .markdown-content p {
            margin-bottom: 0.75em;
        }

        .markdown-content ul,
        .markdown-content ol {
            margin-left: 1.5em;
            margin-bottom: 0.75em;
        }

        .markdown-content li {
            margin-bottom: 0.25em;
        }

        .markdown-content code {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
        }

        .markdown-content pre {
            background-color: rgba(0, 0, 0, 0.05);
            padding: 1em;
            border-radius: 5px;
            overflow-x: auto;
            margin-bottom: 0.75em;
        }

        .markdown-content pre code {
            background-color: transparent;
            padding: 0;
        }

        .markdown-content blockquote {
            border-left: 3px solid #667eea;
            padding-left: 1em;
            margin-left: 0;
            margin-bottom: 0.75em;
            font-style: italic;
            opacity: 0.9;
        }

        .markdown-content a {
            color: #667eea;
            text-decoration: underline;
        }

        .markdown-content a:hover {
            color: #764ba2;
        }

        .markdown-content strong {
            font-weight: 600;
        }

        .markdown-content em {
            font-style: italic;
        }

        .markdown-content hr {
            border: none;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            margin: 1em 0;
        }

        .markdown-content table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 0.75em;
        }

        .markdown-content th,
        .markdown-content td {
            border: 1px solid rgba(0, 0, 0, 0.1);
            padding: 0.5em;
            text-align: left;
        }

        .markdown-content th {
            background-color: rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }
    </style>
</head>

<body class="bg-gray-50">
    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-brain text-3xl"></i>
                    <div>
                        <h1 class="text-2xl font-bold">NeurIPS Abstracts Explorer</h1>
                        <p class="text-sm opacity-90">Explore NeurIPS conference abstracts with AI-powered search</p>
                    </div>
                </div>
                <div id="stats" class="text-right">
                    <div class="text-sm opacity-90">Loading stats...</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Tab Navigation -->
        <div class="bg-white rounded-lg shadow-md mb-6">
            <nav class="flex border-b">
                <button onclick="switchTab('search')" id="tab-search"
                    class="tab-btn flex-1 py-4 px-6 font-semibold text-gray-700 border-b-2 border-purple-600">
                    <i class="fas fa-search mr-2"></i>Search Abstracts (beta)
                </button>
                <button onclick="switchTab('chat')" id="tab-chat"
                    class="tab-btn flex-1 py-4 px-6 font-semibold text-gray-500 border-b-2 border-transparent hover:text-gray-700">
                    <i class="fas fa-comments mr-2"></i>AI Chat (alpha)
                </button>
            </nav>
        </div>

        <!-- Search Tab -->
        <div id="search-tab" class="tab-content">
            <!-- Search Bar -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex gap-4">
                    <div class="flex-1">
                        <input type="text" id="search-input" placeholder="Search for abstracts by keywords or topic..."
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                            onkeypress="if(event.key === 'Enter') searchPapers()">
                    </div>
                    <button onclick="searchPapers()"
                        class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:ring-2 focus:ring-purple-600 focus:ring-offset-2">
                        <i class="fas fa-search mr-2"></i>Search
                    </button>
                </div>

                <!-- Search Options -->
                <div class="mt-4 flex flex-wrap gap-3 items-start">
                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Results per page</label>
                        <select id="limit-select"
                            class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-600">
                            <option value="10">10 results</option>
                            <option value="25">25 results</option>
                            <option value="50">50 results</option>
                            <option value="100">100 results</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Sessions (Ctrl/Cmd+Click for multiple)</label>
                        <select id="session-filter" multiple size="4"
                            class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-600 min-w-[200px]">
                        </select>
                        <div class="flex gap-1 mt-1">
                            <button onclick="selectAllFilter('session-filter')"
                                class="text-xs px-2 py-1 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded">
                                Select All
                            </button>
                            <button onclick="deselectAllFilter('session-filter')"
                                class="text-xs px-2 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded">
                                Deselect All
                            </button>
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Topics (Ctrl/Cmd+Click for multiple)</label>
                        <select id="topic-filter" multiple size="4"
                            class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-600 min-w-[250px]">
                        </select>
                        <div class="flex gap-1 mt-1">
                            <button onclick="selectAllFilter('topic-filter')"
                                class="text-xs px-2 py-1 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded">
                                Select All
                            </button>
                            <button onclick="deselectAllFilter('topic-filter')"
                                class="text-xs px-2 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded">
                                Deselect All
                            </button>
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs text-gray-600 mb-1">Event Type</label>
                        <select id="eventtype-filter"
                            class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-600 min-w-[150px]">
                            <option value="">All Event Types</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Search Results -->
            <div id="search-results" class="space-y-4">
                <div class="text-center text-gray-500 py-12">
                    <i class="fas fa-search text-6xl mb-4 opacity-20"></i>
                    <p class="text-lg">Enter a search query to find abstracts</p>
                    <p class="text-sm">Try "transformer architecture" or "reinforcement learning"</p>
                </div>
            </div>
        </div>

        <!-- Chat Tab -->
        <div id="chat-tab" class="tab-content hidden">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Chat Interface -->
                <div class="lg:col-span-2 bg-white rounded-lg shadow-md overflow-hidden">
                    <!-- Chat Header -->
                    <div class="bg-purple-600 text-white px-6 py-4 flex justify-between items-center">
                        <div>
                            <h3 class="font-semibold text-lg">AI Research Assistant</h3>
                            <p class="text-sm opacity-90">Ask questions about NeurIPS abstracts</p>
                        </div>
                        <button onclick="resetChat()" class="px-4 py-2 bg-white/20 rounded-lg hover:bg-white/30">
                            <i class="fas fa-redo mr-2"></i>Reset
                        </button>
                    </div>

                    <!-- Chat Messages -->
                    <div id="chat-messages" class="h-96 overflow-y-auto p-6 space-y-4 bg-gray-50">
                        <div class="chat-message">
                            <div class="flex items-start gap-3">
                                <div
                                    class="flex-shrink-0 w-8 h-8 bg-purple-600 rounded-full flex items-center justify-center text-white">
                                    <i class="fas fa-robot text-sm"></i>
                                </div>
                                <div class="bg-white text-gray-700 rounded-lg p-4 shadow-sm max-w-2xl">
                                    <div class="markdown-content">
                                        <p>Hello! I'm your AI research assistant. Ask me anything about NeurIPS
                                            abstracts, and I'll help you find relevant research and insights.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chat Input -->
                    <div class="p-6 bg-white border-t">
                        <div class="flex gap-4">
                            <input type="text" id="chat-input"
                                placeholder="Ask about abstracts, research topics, or specific techniques..."
                                class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-600 focus:border-transparent"
                                onkeypress="if(event.key === 'Enter') sendChatMessage()">
                            <button onclick="sendChatMessage()"
                                class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 focus:ring-2 focus:ring-purple-600 focus:ring-offset-2">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="mt-3 flex flex-wrap gap-3 items-start">
                            <div class="text-sm text-gray-500">
                                <label class="inline-flex items-center">
                                    Abstracts in context:
                                    <select id="n-papers" class="ml-2 px-2 py-1 border border-gray-300 rounded text-sm">
                                        <option value="3">3</option>
                                        <option value="5" selected>5</option>
                                        <option value="10">10</option>
                                    </select>
                                </label>
                            </div>
                            
                            <div>
                                <label class="block text-xs text-gray-600 mb-1">Sessions (Ctrl/Cmd+Click)</label>
                                <select id="chat-session-filter" multiple size="2"
                                    class="px-2 py-1 border border-gray-300 rounded text-xs focus:ring-2 focus:ring-purple-600 min-w-[150px]">
                                </select>
                                <div class="flex gap-1 mt-1">
                                    <button onclick="selectAllFilter('chat-session-filter')"
                                        class="text-xs px-1 py-0.5 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded">
                                        All
                                    </button>
                                    <button onclick="deselectAllFilter('chat-session-filter')"
                                        class="text-xs px-1 py-0.5 text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded">
                                        None
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-xs text-gray-600 mb-1">Topics (Ctrl/Cmd+Click)</label>
                                <select id="chat-topic-filter" multiple size="2"
                                    class="px-2 py-1 border border-gray-300 rounded text-xs focus:ring-2 focus:ring-purple-600 min-w-[200px]">
                                </select>
                                <div class="flex gap-1 mt-1">
                                    <button onclick="selectAllFilter('chat-topic-filter')"
                                        class="text-xs px-1 py-0.5 text-purple-600 hover:text-purple-800 hover:bg-purple-50 rounded">
                                        All
                                    </button>
                                    <button onclick="deselectAllFilter('chat-topic-filter')"
                                        class="text-xs px-1 py-0.5 text-gray-600 hover:text-gray-800 hover:bg-gray-50 rounded">
                                        None
                                    </button>
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-xs text-gray-600 mb-1">Event Type</label>
                                <select id="chat-eventtype-filter"
                                    class="px-2 py-1 border border-gray-300 rounded text-xs focus:ring-2 focus:ring-purple-600 min-w-[120px]">
                                    <option value="">All Event Types</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Relevant Papers Panel -->
                <div class="lg:col-span-1 bg-white rounded-lg shadow-md overflow-hidden">
                    <div class="bg-purple-600 text-white px-6 py-4">
                        <h3 class="font-semibold text-lg">
                            <i class="fas fa-file-alt mr-2"></i>Relevant Papers
                        </h3>
                        <p class="text-sm opacity-90">Papers used for the response</p>
                    </div>
                    <div id="chat-papers" class="h-[450px] overflow-y-auto p-4 space-y-3 bg-gray-50">
                        <div class="text-center text-gray-500 py-8">
                            <i class="fas fa-inbox text-4xl mb-3 opacity-20"></i>
                            <p class="text-sm">Ask a question to see relevant papers</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white mt-12">
        <div class="container mx-auto px-4 py-6">
            <div class="text-center">
                <p class="text-sm">Powered by NeurIPS Abstracts Package</p>
                <p class="text-xs text-gray-400 mt-2">Open source project for exploring NeurIPS conference abstracts</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>